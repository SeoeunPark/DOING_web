<!DOCTYPE html>
<meta charset="utf-8">
<html>
  <title>지금모해?</title>
<head>
  <meta name="Info" content="width=device-width, initial-scale=1.0">
  <title>친구의 상태</title>
  <link rel="stylesheet" href="css/doing.css">
  <script src="https://www.gstatic.com/firebasejs/8.6.7/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.7/firebase-database.js"></script>
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>

<body>
  <img src="img/web_bg.png" alt="background" id="bg">
  <input type="button" id="to_ex" onclick="location.href='doing.html'">
  <div class="container">
    <button class="btn btn-1" onclick="demo1()" id="demo1btn">데모계정 1 현재 상태</button>
    <button class="btn btn-2" onclick="demo2()" id="demo2btn">데모계정 2 현재 상태</button>
  </div>
  <div class="card"> 
    <div class="card-image"><img src="img/card.png"alt="card background"></div>
    <div class="content">
      <div class="img_part">
        <img src="img/transparency.png" alt="condition" id="condition">
      </div>
      <div class="text_part">
        <div id="level"> </div>
        <br>
        <div id="name">친구가 무엇을 하는지</div>
        <div id="ing"> 알아보는 중...</div>
        <div id="about"></div>
      </div>
    </div>
    </img>
  </div>
  <script>
    if (getParameter("id") === "O68lFCL8elSauhan3tdfu3oP75s2") {
      document.getElementById("demo1btn").style = "background-color:white;color:black;"
    } else if (getParameter("id") === "yAmFzgtwnjcLMBPLivwjRhcWL1X2") {
      document.getElementById("demo2btn").style = "background-color:white;color:black;"
    }
    function demo1() {
      window.location.href = 'index.html?id=O68lFCL8elSauhan3tdfu3oP75s2'
      }
    function demo2() {
      location.href = 'index.html?id=yAmFzgtwnjcLMBPLivwjRhcWL1X2'
    }
    function getParameter(parameterName) {
      let parameters = new URLSearchParams(window.location.search);
      return parameters.get(parameterName);
    }
    var firebaseConfig = {
      apiKey: "AIzaSyDG-SGv3SxwJ4Rmt__KcBLqraYBeCpr39g",
      authDomain: "doing-651bf.firebaseapp.com",
      databaseURL: "https://doing-651bf-default-rtdb.firebaseio.com",
      projectId: "doing-651bf",
      storageBucket: "doing-651bf.appspot.com",
      messagingSenderId: "489449155904",
      appId: "1:489449155904:web:9c4117a3e3a64246de9ea5",
      measurementId: "G-5ZWNKSF2M2"
    };

    firebase.initializeApp(firebaseConfig);

    var updateStarCount = function (key, value) {
      if (key === "condition") {
        document.getElementById(key).src = "img/emotion" + value + ".png";
      } else if (key === "name") {
        document.getElementById(key).innerHTML = value + "님은";
      } else if (key === "ing") {
        document.getElementById(key).innerHTML = value + "하는 중이에요";
      } else if (key === "about") {
        document.getElementById(key).innerHTML = '<br/>' + "&quot;" + value + "&quot;";
      }

      if (key === "level") {
        if (value == 0) {
          document.getElementById(key).innerHTML = "지금은 여유로워요";
          document.getElementById(key).style = "color: green;";
        } else if (value == 1) {
          document.getElementById(key).innerHTML = "지금은 바빠요";
          document.getElementById(key).style = "color: #ffd700;";
        } else {
          document.getElementById(key).innerHTML = "지금은 매우 바빠요";
          document.getElementById(key).style = "color: #f4413c;";
        }
      }

    };
    var starCountRef = firebase.database().ref("users/" + getParameter("id"))
    starCountRef.on('value', function (snapshot) {
      snapshot.forEach((childSnapshot) => {
        updateStarCount(childSnapshot.key, childSnapshot.val());
      });
    });

  </script>
</body>

</html>